import"./modulepreload-polyfill-B5Qt9EMX.js";const _=t=>{const e=`
        <div class="bg-gray-100 p-8">
            <div class="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl p-8">
                <h1 class="text-2xl font-bold mb-4">장바구니</h1>
                <div id="cart-items"></div>
                <div id="cart-total" class="text-xl font-bold my-4"></div>
                <select id="product-select" class="border rounded p-2 mr-2"></select>
                <button id="add-to-cart" class="bg-blue-500 text-white px-4 py-2 rounded">추가</button>
                <div id="stock-status" classs="text-sm text-gray-500 mt-2"></div>
            </div>
        </div>
    `;t.innerHTML=e;const n=document.getElementById("cart-items"),a=document.getElementById("cart-total"),s=document.getElementById("product-select"),r=document.getElementById("add-to-cart"),c=document.getElementById("stock-status");return{cartItemList:n,cartTotal:a,productSelect:s,addToCartButton:r,stockStatus:c}},u={SALE_ALERT:t=>`번개세일! ${t}이(가) 20% 할인 중입니다!`,SUGGESTION:t=>`${t}은(는) 어떠세요? 지금 구매하시면 5% 추가 할인!`,OUT_OF_STOCK:"재고가 부족합니다.",ADD_SUCCESS:t=>`${t}을(를) 장바구니에 담았습니다.`,POINTS:t=>`(포인트: ${t})`,DISCOUNT:t=>`(${(t*100).toFixed(1)}% 할인 적용)`},w=(t,e,n,a)=>{const s=t.querySelector("span"),r=parseInt(s.textContent.split("x ")[1]),c=r+n,o=e.quantity+r;c>0&&c<=o?(s.textContent=`${e.name} - ${e.val}원 x ${c}`,e.quantity-=n):c<=0?(t.remove(),e.quantity+=r):alert(a.OUT_OF_STOCK)},U=(t,e)=>{const n=t.querySelector("span"),a=parseInt(n.textContent.split("x ")[1]);e.quantity+=a,t.remove()},B=(t,e,n)=>{t.addEventListener("click",a=>{const s=a.target;if(!s.dataset.productId)return;const r=s.dataset.productId,c=document.getElementById(r),o=e.find(i=>i.id===r);if(!(!o||!c)){if(s.classList.contains("quantity-change")){const i=parseInt(s.dataset.change);w(c,o,i,u)}else s.classList.contains("remove-item")&&U(c,o);n()}})},R=t=>{const e=document.createElement("option");return e.value=t.id,e.textContent=`${t.name} - ${t.val}원`,t.quantity===0&&(e.disabled=!0),e},M=(t,e)=>{t.innerHTML="";const n=document.createDocumentFragment();e.forEach(a=>{n.appendChild(R(a))}),t.appendChild(n)},N=t=>{const e=document.createElement("div");return e.id=t.id,e.className="flex justify-between items-center mb-2",e.innerHTML=`<span>${t.name} - ${t.val}원 x 1</span>
            <div>
                <button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${t.id}" data-change="-1">-</button>
                <button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${t.id}" data-change="1">+</button>
                <button class="remove-item bg-red-500 text-white px-2 py-1 rounded" data-product-id="${t.id}">삭제</button>
            </div>`,e},P=(t,e)=>{const n=t.querySelector("span"),a=parseInt(n.textContent.split("x ")[1])+1;a<=e.quantity?(n.textContent=`${e.name} - ${e.val}원 x ${a}`,e.quantity--):alert(messages.OUT_OF_STOCK)},k=({productSelectElement:t,productList:e,cartItemList:n,calculationCart:a,lastSelectedProduct:s})=>function(){const r=t.value,c=e.find(i=>i.id===r);if(!c||c.quantity<=0){alert(u.OUT_OF_STOCK);return}const o=document.getElementById(c.id);if(o)P(o,c);else{const i=N(c);n.appendChild(i),c.quantity--}a(),s=r},F=(t,e,n,a,s,r)=>(e.addEventListener("click",function(){k({productSelectElement:t,productList:n,cartItemList:a,calculationCart:s,lastSelectedProduct:r})()}),{updateSelectOptions:()=>M(t,n)}),K=(t,e,n)=>{const a=()=>{const o=t.filter(i=>i.quantity>0);return o[Math.floor(Math.random()*o.length)]},s=()=>{setInterval(()=>{const o=a();o&&(o.val=Math.round(o.val*.8),alert(u.SALE_ALERT(o.name)),n())},3e4)},r=()=>{setInterval(()=>{if(e){const o=t.find(i=>i.id!==e&&i.quantity>0);o&&(o.val=Math.round(o.val*.95),alert(u.SUGGESTION(o.name)),n())}},6e4)};return{start:()=>{setTimeout(s,Math.random()*1e4),setTimeout(r,Math.random()*2e4)}}},Q=(t,e,n)=>{if(t.textContent="총액: "+Math.round(e)+"원",n>0){const a=document.createElement("span");a.className="text-green-500 ml-2",a.textContent="("+(n*100).toFixed(1)+"% 할인 적용)",t.appendChild(a)}},H=(t,e,n)=>{e=Math.floor(n/1e3);let a=document.getElementById("loyalty-points");a||(a=document.createElement("span"),a.id="loyalty-points",a.className="text-blue-500 ml-2",t.appendChild(a)),a.textContent="(포인트: "+e+")"},G=(t,e)=>{let n="";t.forEach(function(a){a.quantity<5&&(n+=a.name+": "+(a.quantity>0?"재고 부족 ("+a.quantity+"개 남음)":"품절")+`
`)}),e.textContent=n},A=[{id:"p1",name:"상품1",val:1e4,quantity:50},{id:"p2",name:"상품2",val:2e4,quantity:30},{id:"p3",name:"상품3",val:3e4,quantity:20},{id:"p4",name:"상품4",val:15e3,quantity:0},{id:"p5",name:"상품5",val:25e3,quantity:10}],W={p1:.1,p2:.15,p3:.2,p4:.05,p5:.25},j=30,x=.25,Y=2,z=(t,e)=>t.val*e,J=(t,e)=>e>=10&&W[t.id]||0,V=(t,e,n)=>{if(t>=j){const a=n*x,s=n-e;return a>s?{discountRate:x,totalAmount:n*(1-x)}:{discountRate:s/n,totalAmount:e}}return{discountRate:(n-e)/n,totalAmount:e}},X=(t,e)=>{if(new Date().getDay()===Y){const n=t*.9;return e=Math.max(e,.1),{discountedTotal:n,discountRate:e}}return{discountedTotal:t,discountRate:e}},f=(t,e,n,a,s)=>{const r=t.children;let c=0,o=0,i=0,l=0;Array.from(r).forEach(g=>{const L=g.id,p=parseInt(g.querySelector("span").textContent.split("x ")[1]),y=e.find($=>$.id===L);if(!y)return;const I=z(y,p),D=J(y,p);c+=p,o+=I,i+=I*(1-D)});const{discountRate:T,totalAmount:q}=V(c,i,o);l=T,i=q;const{discountedTotal:E,discountRate:O}=X(i,l);return i=E,l=O,Q(n,i,l),G(e,a),H(n,s,i),i},v={productList:[],lastSelectedProduct:null,bonusPoints:0},d=()=>v,Z=t=>{Object.assign(v,t)},tt=document.getElementById("app"),{cartItemList:m,cartTotal:C,productSelect:et,addToCartButton:nt,stockStatus:S}=_(tt);Z({productList:[...A],lastSelectedProduct:null,bonusPoints:0});const h=()=>{const{productList:t,bonusPoints:e}=d();f(m,t,C,S,e)};B(m,d().productList,h);const{updateSelectOptions:b}=F(et,nt,d().productList,m,h,d().lastSelectedProduct);b();f(m,d().productList,C,S,d().bonusPoints);K(d().productList,d().lastSelectedProduct,b);
